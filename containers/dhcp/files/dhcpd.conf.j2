authoritative;
ddns-update-style interim;
default-lease-time 14400;
max-lease-time 14400;

	option routers                  {{ dhcp.router }};
	option broadcast-address        {{ dhcp.bcast }};
	option subnet-mask              {{ dhcp.netmask }};
	option domain-name-servers      {{ helper.ipaddr }};
	option domain-name              "{{ dns.clusterid }}.{{ dns.domain | lower }}";
	option domain-search            "{{ dns.clusterid }}.{{ dns.domain | lower }}", "{{ dns.domain | lower }}";
	option client-architecture code 93 = unsigned integer 16;

	subnet {{ dhcp.ipid }} netmask {{ dhcp.netmaskid }} {
	interface {{ helper.networkifacename }};
     	pool {
        	range {{ dhcp.poolstart }} {{ dhcp.poolend }};
		# Static entries
{% if bootstrap is defined %}
		host {{ bootstrap.name | lower }} { hardware ethernet {{ bootstrap.macaddr }}; fixed-address {{ bootstrap.ipaddr }}; }
{% endif %}
{% if masters is defined %}
{% for m in masters %}
		host {{ m.name | lower }} { hardware ethernet {{ m.macaddr }}; fixed-address {{ m.ipaddr }}; }
{% endfor %}
{% endif %}
{% if workers is defined %}
{% for w in workers %}
		host {{ w.name | lower }} { hardware ethernet {{ w.macaddr }}; fixed-address {{ w.ipaddr }}; }
{% endfor %}
{% endif %}
{% if other is defined %}
{% for o in other %}
{% if o.macaddr is defined %}
		host {{ o.name }} { hardware ethernet {{ o.macaddr }}; fixed-address {{ o.ipaddr }}; }
{% endif %}
{% endfor %}
{% endif %}
		# this will not give out addresses to hosts not listed above
		deny unknown-clients;

		# this is PXE specific
{% if ppc64le is sameas true %}
		filename "boot/grub2/powerpc-ieee1275/core.elf";
{% else %}

		if exists user-class and option user-class = "iPXE" {
			filename "menu/boot.ipxe";
		} elsif option client-architecture = 00:00 {
			filename "pxelinux.0";
		} else {
			filename "ipxe-x86_64.efi";
		}
{% endif %}

		next-server {{ helper.ipaddr }};
     	}
}
